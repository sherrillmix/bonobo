library(dnar)
library(dnaplotr)
library(levenR)

r1<-read.fastq('data/Weimin_10_13_16_2/PA1044matK-bd_S51_L001_R1_001.fastq.gz')
r2<-read.fastq('data/Weimin_10_13_16_2/PA1044matK-bd_S51_L001_R2_001.fastq.gz')
quals1<-do.call(rbind,qualToInts(r1$qual))
quals2<-do.call(rbind,qualToInts(r2$qual))

align1<-levenAlign(r1$seq,mostAbundant(r1$seq),nThreads=40)
align2<-levenAlign(r1$seq,mostAbundant(r1$seq),nThreads=40)
png('r1_align.png',width=6000,height=6000,res=500)
plotDNA(removeGapCols(align1[[2]][order(leven(r1$seq,mostAbundant(r1$seq),nThreads=40),r1$seq)]))
dev.off()
png('r2_align.png',width=6000,height=6000,res=500)
plotDNA(removeGapCols(align2[[2]][order(leven(r2$seq,mostAbundant(r2$seq),nThreads=40),r2$seq)]))
dev.off()
png('r1.png',width=6000,height=6000,res=500)
plotDNA(sort(r1$seq))
dev.off()
png('r2.png',width=6000,height=6000,res=500)
plotDNA(sort(r2$seq))
dev.off()
png('r1_rev.png',width=6000,height=6000,res=500)
plotDNA(sort(reverseString(r1$seq)))
dev.off()
png('r2_rev.png',width=6000,height=6000,res=500)
plotDNA(sort(reverseString(r2$seq)))
dev.off()
